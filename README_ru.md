# Пайплайн обучения сегментационной модели с использованием библиотеки segmentation_models_pytorch (smp)

Этот проект включает в себя скрипт для обучения сегментационной модели с использованием библиотеки PyTorch и segmentation_models_pytorch (smp).

## Особенности

- Использование предварительно обученных энкодеров из библиотеки smp.
- Поддержка различных архитектур моделей сегментации.
- Возможность легкой настройки параметров обучения через аргументы командной строки.
- Автоматическое разделение данных на обучающую и валидационную выборки.

## Требования

Для запуска скрипта необходимо установить следующие библиотеки:

- PyTorch
- torchvision
- segmentation_models_pytorch
- split-folders

Установка зависимостей:

```
pip install torch torchvision segmentation-models-pytorch split-folders
```
## Использование

Скрипт поддерживает следующие аргументы командной строки:

    --data: Путь к данным для обработки (по умолчанию пустой).
    --epochs: Количество эпох обучения (по умолчанию 10).
    --batch_size: Размер батча (по умолчанию 4).
    --learning_rate: Скорость обучения (по умолчанию 0.0003).
    --model_name: Название модели из smp (по умолчанию 'Unet').
    --encoder_name: Название энкодера (по умолчанию 'efficientnet-b0').
    --activation: Функция активации (по умолчанию 'softmax2d').
    --classes: Список классов, разделенных запятыми (по умолчанию 'tower').

## Пример запуска
```
python train.py --data /path/to/data --epochs 20 --batch_size 8 --learning_rate 0.001 --model_name Unet --encoder_name resnet34 --activation softmax2d --classes class1,class2
```
## Структура данных

Данные должны быть предварительно подготовлены и иметь следующую структуру:

```
/path/to/data/
    ├── images/
    │   ├── img1.jpg
    │   ├── img2.jpg
    │   └── ...
    └── masks/
        ├── img1.png
        ├── img2.png
        └── ...
```

После запуска скрипта будет создана директория train_val_test на том же уровне, что и указанная директория данных, с разделением на обучающую и валидационную выборки.